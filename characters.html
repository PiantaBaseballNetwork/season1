<html lang="en">

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="styles.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Characters</title>
	<link rel="icon" href="Assets/tab_icon.png">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>

<!-- Header -->
<header>
	<div class="container">
	
		<a href="index.html"><img src="Assets/mb_logo.png" alt="baseball logo" class="logo"></a>
		
		<nav>
			<ul>
				<li><a href="teams.html">Teams</a></li>
				<li><a href="characters.html">Characters</a></li>
				<li><a href="matches.html">Matches</a></li>
				<li><a href="archive.html">Archive</a></li>
			</ul>
		</nav>
		
	</div>
</header>
	
<!-- Contents -->
<table class="stattable">
	<tr>
		<th class="fixed-row" data-column="CharacterName" data-order="desc">Name &#9642</th>
		<th class="fixed-row" data-column="IsCaptain" data-order="none">Captain &#9642</th>
		<th class="fixed-row" data-column="GamesPlayed" data-order="none">Games Played &#9642</th>
		
		<!-- Batting -->
		<th class="fixed-row" data-column="Hits" data-order="none">Hits &#9642</th>
		<th class="fixed-row" data-column="Singles" data-order="none">Singles &#9642</th>
		<th class="fixed-row" data-column="Doubles" data-order="none">Doubles &#9642</th>
		<th class="fixed-row" data-column="Triples" data-order="none">Triples &#9642</th>
		<th class="fixed-row" data-column="Homeruns" data-order="none">Homeruns &#9642</th>
		<th class="fixed-row" data-column="StrikeoutsSwung" data-order="none">Strikeouts(batted) &#9642</th>
		<th class="fixed-row" data-column="BallWalks" data-order="none">Walks(ball) &#9642</th>
		<th class="fixed-row" data-column="HitWalks" data-order="none">Walks(hit) &#9642</th>
		<th class="fixed-row" data-column="BasesStolen" data-order="none">Bases Stolen &#9642</th>
		<th class="fixed-row" data-column="BattingAVG" data-order="none">Batting AVG &#9642</th>
		
		<!-- Pitching -->
		<th class="fixed-row" data-column="InningsPitched" data-order="none">Innings Pitched &#9642</th>
		<th class="fixed-row" data-column="ERA" data-order="none">ERA &#9642</th>
		<th class="fixed-row" data-column="StrikeoutsThrown" data-order="none">Strikeouts(pitched) &#9642</th>
		<th class="fixed-row" data-column="BattersWalked" data-order="none">Batters Walked &#9642</th>
		<th class="fixed-row" data-column="BattersHit" data-order="none">Batters Hit &#9642</th>
		
	</tr>
	
	<tbody id="teamtable">
	
	</tbody>
</table>

<script>
	var myArray = 1;

	fetch("LeagueData.json")
		.then(response => response.json())
		.then(data => {
			console.log(data.Seasons[0].Characters)
			myArray = data.Seasons[0].Characters
			buildTable(data.Seasons[0].Characters)
		})
	
	lastClick = -99;
	lastColumn = -99;
	
	$('th').on('click', function(){
		var column = $(this).data('column')
		var order = $(this).data('order')
		var text = $(this).html()
		text = text.substring(0, text.length -1)
		
		console.log('Click', column, order)
		
		if(lastClick != -99)
		{
			lastText = lastClick.html()
			lastText = lastText.substring(0, lastText.length -1)
			lastText += '&#9642'
			lastClick.html(lastText)
			
			
			lastClick.data('order', "none")
		}
		
		if(order == 'desc' && lastColumn == column){
			$(this).data('order', "asc")
			
			myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
				
			text += '&#9660'
		}else if(order == 'asc' && lastColumn == column){
			$(this).data('order', "desc")
			
			myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
				
			text += '&#9650'
		}else{
			$(this).data('order', "desc")
			
			myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
				
			text += '&#9650'
		}
		
		lastColumn = column;
		lastClick = $(this);
		
		$(this).html(text)

		buildTable(myArray)
	})
	
	function buildTable(data){
		console.log("BuildingTable")
		var table = document.getElementById('teamtable')
		table.innerHTML = ''
		for(var i = 0; i < data.length; i++){
			var row = `<tr>
				<td class="fixed-column">${data[i].CharacterName}</td>
				<td>${data[i].IsCaptain}</td>
				<td>${data[i].GamesPlayed}</td>
				
				<td>${data[i].Hits}</td>
				<td>${data[i].Singles}</td>
				<td>${data[i].Doubles}</td>
				<td>${data[i].Triples}</td>
				<td>${data[i].Homeruns}</td>
				<td>${data[i].StrikeoutsSwung}</td>
				<td>${data[i].BallWalks}</td>
				<td>${data[i].HitWalks}</td>
				<td>${data[i].BasesStolen}</td>
				<td>${data[i].BattingAVG}</td>
				
				<td>${data[i].InningsPitched}</td>
				<td>${data[i].ERA}</td>
				<td>${data[i].StrikeoutsThrown}</td>
				<td>${data[i].BattersWalked}</td>
				<td>${data[i].BattersHit}</td>
			</tr>`
			
			table.innerHTML += row
		}
	}
</script>
	
	
</body>
</html>