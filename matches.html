<html lang="en">

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="styles.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Matches</title>
	<link rel="icon" href="Assets/tab_icon.png">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>

<!-- Header -->
<header>
	<div class="nav-container">
	
		<a href="index.html"><img src="Assets/mb_logo.png" alt="baseball logo" class="logo"></a>
		
		<nav>
			<ul>
				<li><a href="teams.html">Teams</a></li>
				<li><a href="characters.html">Characters</a></li>
				<li><a href="matches.html">Matches</a></li>
				<li><a href="archive.html">Archive</a></li>
			</ul>
		</nav>
		
	</div>
</header>
	
<!-- Contents -->
<div class="table-container">
<table class="gridview">
<thead>
	<tr>
		<th data-column="HomeTeam" data-order="desc">Home &#9642</th>
		<th data-column="HomeScore" data-order="none">Score(H) &#9642</th>
		<th data-column="AwayTeam" data-order="none">Away &#9642</th>
		<th data-column="AwayScore" data-order="none">Score(A) &#9642</th>
		<th data-column="Stadium" data-order="none">Stadium &#9642</th>
		<th data-column="InningsPlayed" data-order="none">Innings &#9642</th>
		<th data-column="Date" data-order="none">Date &#9642</th>
	</tr>
</thead>
	
	<tbody id="teamtable">
	
	</tbody>
</table>
</div>

<script>
	var myArray = 1;

	fetch("LeagueData.json")
		.then(response => response.json())
		.then(data => {
			console.log(data.Seasons[0].Games)
			myArray = data.Seasons[0].Games
			buildTable(data.Seasons[0].Games)
		})
	
	lastClick = -99;
	lastColumn = -99;
	
	$('th').on('click', function(){
		var column = $(this).data('column')
		var order = $(this).data('order')
		var text = $(this).html()
		text = text.substring(0, text.length -1)
		
		console.log('Click', column, order)
		
		if(lastClick != -99)
		{
			lastText = lastClick.html()
			lastText = lastText.substring(0, lastText.length -1)
			lastText += '&#9642'
			lastClick.html(lastText)
			
			
			lastClick.data('order', "none")
		}
		
		if(order == 'desc' && lastColumn == column){
			$(this).data('order', "asc")
			
			myArray = myArray.sort((a,b) => a[column] > b[column] ? 1 : -1)
				
			text += '&#9660'
		}else if(order == 'asc' && lastColumn == column){
			$(this).data('order', "desc")
			
			myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
				
			text += '&#9650'
		}else{
			$(this).data('order', "desc")
			
			myArray = myArray.sort((a,b) => a[column] < b[column] ? 1 : -1)
				
			text += '&#9650'
		}
		
		lastColumn = column;
		lastClick = $(this);
		
		$(this).html(text)

		buildTable(myArray)
	})
	
	function buildTable(data){
		console.log("BuildingTable")
		var table = document.getElementById('teamtable')
		table.innerHTML = ''
		for(var i = 0; i < data.length; i++){
			var row = `<tr>
				<td>${data[i].HomeTeam}</td>
				<td>${data[i].HomeScore}</td>
				<td>${data[i].AwayTeam}</td>
				<td>${data[i].AwayScore}</td>
				<td>${data[i].Stadium}</td>
				<td>${data[i].InningsPlayed}</td>
				<td>${data[i].Date}</td>
			</tr>`
			
			table.innerHTML += row
		}
	}	
</script>
	
	
</body>
</html>